<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.0 Transitional//EN' 'http://www.w3.org/TR/REC-html40/loose.dtd'>
<!--NewPage-->
<HTML>
<HEAD>
	<!-- Generated by PhpDoc date: 'Wed, 30 Apr 2003 11:14:31 -0400' -->
	<TITLE>Docs For Class Parser</TITLE>
<LINK REL ='stylesheet' TYPE='text/css' HREF='../media/stylesheet.css' TITLE='Style'>
</HEAD>
<BODY>
<table width="100%" border="0">
	<tr>
		<td align="left" valign="top" bgcolor="#B0BAFF">			
			<table width="100%">
				<tr>
					<td align="left" valign="top"><a href="../classtrees_Spreadsheet_WriteExcel.html">Class Trees</a></td>
					<td align="left" valign="top"><a href="../elementindex_Spreadsheet_WriteExcel.html">Index</a></td>
					<td align="left" valign="top"><a href="http://phpdocu.sourceforge.net">phpDocumentor Project Page</a></td>
				</tr>
			</table>	
		</td>
	</tr>
</table>
<a name="top"><!-- --></a><!-- Start of Class Data -->
<H2>
	Class Parser
</H2>
(line <span class="linenumber">71</span>)<br />
<pre>
</pre>
<p>
	<b><i>Located in File: Program_Root/Parser.php</i></b><br>
</p>
<hr>
<b>Class for parsing Excel formulas</b><br>

<UL>
		<LI><b>Package</b> - <CODE>Spreadsheet_WriteExcel</CODE></LI>
		<LI><b>Author</b> - <CODE>Xavier Noguer &lt;<a href="mailto:xnoguer@rezebra.com">mailto:xnoguer@rezebra.com</a>&gt;</CODE></LI>
	</UL>
<hr>
<!-- =========== VAR SUMMARY =========== -->
<A NAME='var_summary'><!-- --></A>
<h2>Class Variable Summary</h2>
<TABLE BORDER='1' CELLPADDING='3' CELLSPACING='0' WIDTH='100%'>

	</TABLE>

<hr>
<!-- =========== INHERITED VAR SUMMARY =========== -->
<A NAME='inheritedvar_summary'><!-- --></A>
<h2>Inherited Class Variable Summary</h2>
<TABLE BORDER='1' CELLPADDING='3' CELLSPACING='0' WIDTH='100%'>

	</TABLE>
<hr>
<!-- =========== METHOD SUMMARY =========== -->
<A NAME='method_summary'><!-- --></A>
<H2>Method Summary</H2>
<TABLE BORDER='1' CELLPADDING='3' CELLSPACING='0' WIDTH='100%'>

		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#parse'><H4>parse ( $formula )</H4></A>
			<BR>
			<blockquote> The parsing method. It parses a formula. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#Parser'><H4>constructor Parser ( [$byte_order = 0] )</H4></A>
			<BR>
			<blockquote> The class constructor </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#to_reverse_polish'><H4>to_reverse_polish ( [$tree = array()] )</H4></A>
			<BR>
			<blockquote> Builds a string containing the tree in reverse polish notation (What you  would use in a HP calculator stack). </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_advance'><H4>_advance (  )</H4></A>
			<BR>
			<blockquote> Advance to the next valid token. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_cell_to_packed_rowcol'><H4>_cell_to_packed_rowcol ( $cell )</H4></A>
			<BR>
			<blockquote> pack() row and column into the required 3 byte format. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_cell_to_rowcol'><H4>_cell_to_rowcol ( $cell )</H4></A>
			<BR>
			<blockquote> Convert an Excel cell reference such as A1 or $B2 or C$3 or $D$4 to a zero  indexed row and column number. Also returns two boolean values to indicate  whether the row or column are relative references. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_convert'><H4>_convert ( $token )</H4></A>
			<BR>
			<blockquote> Convert a token to the proper ptg value. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_convert_function'><H4>_convert_function ( $token, $num_args )</H4></A>
			<BR>
			<blockquote> Convert a function to a ptgFunc or ptgFuncVarV depending on the number of  args that it takes. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_convert_number'><H4>_convert_number ( $num )</H4></A>
			<BR>
			<blockquote> Convert a number token to ptgInt or ptgNum </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_convert_range2d'><H4>_convert_range2d ( $range )</H4></A>
			<BR>
			<blockquote> Convert an Excel range such as A1:D4 to a ptgRefV. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_convert_ref2d'><H4>_convert_ref2d ( $cell )</H4></A>
			<BR>
			<blockquote> Convert an Excel reference such as A1, $B2, C$3 or $D$4 to a ptgRefV. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_create_tree'><H4>_create_tree ( $value, $left, $right )</H4></A>
			<BR>
			<blockquote> Creates a tree. In fact an array which may have one or two arrays (sub-trees)  as elements. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >mixed</td><td align="left" valign="top" width="100%">
			<A HREF='#_expression'><H4>_expression (  )</H4></A>
			<BR>
			<blockquote> It parses a expression. It assumes the following rule:  Expr -&gt; Term [("+" | "-") Term] </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >mixed</td><td align="left" valign="top" width="100%">
			<A HREF='#_fact'><H4>_fact (  )</H4></A>
			<BR>
			<blockquote> It parses a factor. It assumes the following rule: </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_func'><H4>_func (  )</H4></A>
			<BR>
			<blockquote> It parses a function call. It assumes the following rule: </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_initialize_hashes'><H4>_initialize_hashes (  )</H4></A>
			<BR>
			<blockquote> Initialize the ptg and function hashes. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_match'><H4>_match ( $token )</H4></A>
			<BR>
			<blockquote> Checks if it's a valid token. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >mixed</td><td align="left" valign="top" width="100%">
			<A HREF='#_parenthesized_expression'><H4>_parenthesized_expression (  )</H4></A>
			<BR>
			<blockquote> This function just introduces a ptgParen element in the tree, so that Excel  doesn't get confused when working with a parenthesized formula afterwards. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >mixed</td><td align="left" valign="top" width="100%">
			<A HREF='#_term'><H4>_term (  )</H4></A>
			<BR>
			<blockquote> It parses a term. It assumes the following rule:  Term -&gt; Fact [("*" | "/") Fact] </blockquote>
		</TD></tr></table>
	</td></TR>
	</TABLE>
<!-- =========== INHERITED METHOD SUMMARY =========== -->
<A NAME='functions_inherited'><!-- --></A>
<H2>Inherited Method Summary</H2>
<TABLE BORDER='1' CELLPADDING='3' CELLSPACING='0' WIDTH='100%'>

	</TABLE>
<hr>
<!-- ============ METHOD DETAIL =========== -->

<A NAME='method_detail'></A>
<H2>Method Detail</H2>
<A NAME='parse'><!-- --></A><H3>parse <span class="functionlinenumber">(line 764)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>parse ( $formula )</H4></td></tr></table>

<b>The parsing method. It parses a formula.</b><br>

<DL>

	<DT>Function Info:</DT>
		<DD><b>Access</b> - <CODE>public</CODE></DD>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='Parser'><!-- --></A><H3>Parser <span class="functionlinenumber">(line 79)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>constructor Parser ( [$byte_order = 0] )</H4></td></tr></table>

<b>The class constructor</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='to_reverse_polish'><!-- --></A><H3>to_reverse_polish <span class="functionlinenumber">(line 969)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>to_reverse_polish ( [$tree = array()] )</H4></td></tr></table>

<b>Builds a string containing the tree in reverse polish notation (What you  would use in a HP calculator stack).</b><br>
<p>The following tree:</p><p>+    / \   2   3</p><p>produces: "23+"</p><p>The following tree:</p><p>+    / \   3   *      / \     6   A1</p><p>produces: "36A1*+"</p><p>In fact all operands, functions, references, etc... are written as ptg's</p>
<DL>

	<DT>Function Info:</DT>
		<DD><b>Access</b> - <CODE>public</CODE></DD>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_advance'><!-- --></A><H3>_advance <span class="functionlinenumber">(line 659)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_advance (  )</H4></td></tr></table>

<b>Advance to the next valid token.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_cell_to_packed_rowcol'><!-- --></A><H3>_cell_to_packed_rowcol <span class="functionlinenumber">(line 604)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_cell_to_packed_rowcol ( $cell )</H4></td></tr></table>

<b>pack() row and column into the required 3 byte format.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_cell_to_rowcol'><!-- --></A><H3>_cell_to_rowcol <span class="functionlinenumber">(line 631)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_cell_to_rowcol ( $cell )</H4></td></tr></table>

<b>Convert an Excel cell reference such as A1 or $B2 or C$3 or $D$4 to a zero  indexed row and column number. Also returns two boolean values to indicate  whether the row or column are relative references.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_convert'><!-- --></A><H3>_convert <span class="functionlinenumber">(line 444)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_convert ( $token )</H4></td></tr></table>

<b>Convert a token to the proper ptg value.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_convert_function'><!-- --></A><H3>_convert_function <span class="functionlinenumber">(line 510)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_convert_function ( $token, $num_args )</H4></td></tr></table>

<b>Convert a function to a ptgFunc or ptgFuncVarV depending on the number of  args that it takes.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_convert_number'><!-- --></A><H3>_convert_number <span class="functionlinenumber">(line 487)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_convert_number ( $num )</H4></td></tr></table>

<b>Convert a number token to ptgInt or ptgNum</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_convert_range2d'><!-- --></A><H3>_convert_range2d <span class="functionlinenumber">(line 535)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_convert_range2d ( $range )</H4></td></tr></table>

<b>Convert an Excel range such as A1:D4 to a ptgRefV.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_convert_ref2d'><!-- --></A><H3>_convert_ref2d <span class="functionlinenumber">(line 576)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_convert_ref2d ( $cell )</H4></td></tr></table>

<b>Convert an Excel reference such as A1, $B2, C$3 or $D$4 to a ptgRefV.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_create_tree'><!-- --></A><H3>_create_tree <span class="functionlinenumber">(line 938)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_create_tree ( $value, $left, $right )</H4></td></tr></table>

<b>Creates a tree. In fact an array which may have one or two arrays (sub-trees)  as elements.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_expression'><!-- --></A><H3>_expression <span class="functionlinenumber">(line 779)</span></H3>
<table><tr><td valign="top" align="right">mixed</td><td align="left" valign="top" width="100%"><H4>_expression (  )</H4></td></tr></table>

<b>It parses a expression. It assumes the following rule:  Expr -&gt; Term [("+" | "-") Term]</b><br>

<DL>

	<DT>Function Info:</DT>
		<DD><b>Return</b> - <CODE>The parsed ptg'd tree</CODE></DD>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_fact'><!-- --></A><H3>_fact <span class="functionlinenumber">(line 846)</span></H3>
<table><tr><td valign="top" align="right">mixed</td><td align="left" valign="top" width="100%"><H4>_fact (  )</H4></td></tr></table>

<b>It parses a factor. It assumes the following rule:</b><br>
<p>Fact -&gt; ( Expr )        | CellRef        | CellRange        | Number        | Function</p>
<DL>

	<DT>Function Info:</DT>
		<DD><b>Return</b> - <CODE>The parsed ptg'd tree</CODE></DD>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_func'><!-- --></A><H3>_func <span class="functionlinenumber">(line 895)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_func (  )</H4></td></tr></table>

<b>It parses a function call. It assumes the following rule:</b><br>
<p>Func -&gt; ( Expr [,Expr]* )</p>
<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_initialize_hashes'><!-- --></A><H3>_initialize_hashes <span class="functionlinenumber">(line 95)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_initialize_hashes (  )</H4></td></tr></table>

<b>Initialize the ptg and function hashes.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_match'><!-- --></A><H3>_match <span class="functionlinenumber">(line 699)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_match ( $token )</H4></td></tr></table>

<b>Checks if it's a valid token.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_parenthesized_expression'><!-- --></A><H3>_parenthesized_expression <span class="functionlinenumber">(line 805)</span></H3>
<table><tr><td valign="top" align="right">mixed</td><td align="left" valign="top" width="100%"><H4>_parenthesized_expression (  )</H4></td></tr></table>

<b>This function just introduces a ptgParen element in the tree, so that Excel  doesn't get confused when working with a parenthesized formula afterwards.</b><br>

<DL>

	<DT>Function Info:</DT>
		<DD><b>Return</b> - <CODE>The parsed ptg'd tree</CODE></DD>
		<DD><b>See</b> - <CODE>_fact">_fact</a></CODE></DD>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_term'><!-- --></A><H3>_term <span class="functionlinenumber">(line 817)</span></H3>
<table><tr><td valign="top" align="right">mixed</td><td align="left" valign="top" width="100%"><H4>_term (  )</H4></td></tr></table>

<b>It parses a term. It assumes the following rule:  Term -&gt; Fact [("*" | "/") Fact]</b><br>

<DL>

	<DT>Function Info:</DT>
		<DD><b>Return</b> - <CODE>The parsed ptg'd tree</CODE></DD>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<hr>
<!-- ============ VARIABLE DETAIL =========== -->

<A NAME='variable_detail'></A>
<H2>Variable Detail</H2>

<hr>
	<div id="credit">
		<hr>
		Documention generated on Wed, 30 Apr 2003 11:14:31 -0400 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.2.0</a>
	</div>
</body>
</html>