<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.0 Transitional//EN' 'http://www.w3.org/TR/REC-html40/loose.dtd'>
<!--NewPage-->
<HTML>
<HEAD>
	<!-- Generated by PhpDoc date: 'Wed, 30 Apr 2003 11:14:31 -0400' -->
	<TITLE>Docs For Class OLEwriter</TITLE>
<LINK REL ='stylesheet' TYPE='text/css' HREF='../media/stylesheet.css' TITLE='Style'>
</HEAD>
<BODY>
<table width="100%" border="0">
	<tr>
		<td align="left" valign="top" bgcolor="#B0BAFF">			
			<table width="100%">
				<tr>
					<td align="left" valign="top"><a href="../classtrees_Spreadsheet_WriteExcel.html">Class Trees</a></td>
					<td align="left" valign="top"><a href="../elementindex_Spreadsheet_WriteExcel.html">Index</a></td>
					<td align="left" valign="top"><a href="http://phpdocu.sourceforge.net">phpDocumentor Project Page</a></td>
				</tr>
			</table>	
		</td>
	</tr>
</table>
<a name="top"><!-- --></a><!-- Start of Class Data -->
<H2>
	Class OLEwriter
</H2>
(line <span class="linenumber">41</span>)<br />
<pre>
</pre>
<p>
	<b><i>Located in File: Program_Root/OLEwriter.php</i></b><br>
</p>
<hr>
<b>Class for creating OLE streams for Excel Spreadsheets</b><br>

<UL>
		<LI><b>Package</b> - <CODE>Spreadsheet_WriteExcel</CODE></LI>
		<LI><b>Author</b> - <CODE>Xavier Noguer &lt;<a href="mailto:xnoguer@rezebra.com">mailto:xnoguer@rezebra.com</a>&gt;</CODE></LI>
	</UL>
<hr>
<!-- =========== VAR SUMMARY =========== -->
<A NAME='var_summary'><!-- --></A>
<h2>Class Variable Summary</h2>
<TABLE BORDER='1' CELLPADDING='3' CELLSPACING='0' WIDTH='100%'>

		<!-- =========== Summary =========== -->
	<TR>
		<TD width="100%">
			<h4><A HREF="#$_biffsize">$_biffsize</A></h4>
			<BR>
			<blockquote> Size of the data to be written to the OLE stream </blockquote>
			<blockquote> Default Value: <CODE>-><-</CODE> </blockquote>
		</TD>
	</TR>
		<!-- =========== Summary =========== -->
	<TR>
		<TD width="100%">
			<h4><A HREF="#$_big_blocks">$_big_blocks</A></h4>
			<BR>
			<blockquote> Number of big blocks in the OLE stream </blockquote>
			<blockquote> Default Value: <CODE>-><-</CODE> </blockquote>
		</TD>
	</TR>
		<!-- =========== Summary =========== -->
	<TR>
		<TD width="100%">
			<h4><A HREF="#$_booksize">$_booksize</A></h4>
			<BR>
			<blockquote> Real data size to be written to the OLE stream </blockquote>
			<blockquote> Default Value: <CODE>-><-</CODE> </blockquote>
		</TD>
	</TR>
		<!-- =========== Summary =========== -->
	<TR>
		<TD width="100%">
			<h4><A HREF="#$_fileclosed">$_fileclosed</A></h4>
			<BR>
			<blockquote> Variable for preventing closing two times </blockquote>
			<blockquote> Default Value: <CODE>-><-</CODE> </blockquote>
		</TD>
	</TR>
		<!-- =========== Summary =========== -->
	<TR>
		<TD width="100%">
			<h4><A HREF="#$_filehandle">$_filehandle</A></h4>
			<BR>
			<blockquote> Filehandle for the OLE stream </blockquote>
			<blockquote> Default Value: <CODE>-><-</CODE> </blockquote>
		</TD>
	</TR>
		<!-- =========== Summary =========== -->
	<TR>
		<TD width="100%">
			<h4><A HREF="#$_list_blocks">$_list_blocks</A></h4>
			<BR>
			<blockquote> Number of list blocks in the OLE stream </blockquote>
			<blockquote> Default Value: <CODE>-><-</CODE> </blockquote>
		</TD>
	</TR>
		<!-- =========== Summary =========== -->
	<TR>
		<TD width="100%">
			<h4><A HREF="#$_OLEfilename">$_OLEfilename</A></h4>
			<BR>
			<blockquote> Filename for the OLE stream </blockquote>
			<blockquote> Default Value: <CODE>-><-</CODE> </blockquote>
		</TD>
	</TR>
		<!-- =========== Summary =========== -->
	<TR>
		<TD width="100%">
			<h4><A HREF="#$_root_start">$_root_start</A></h4>
			<BR>
			<blockquote> Number of big blocks in the OLE stream </blockquote>
			<blockquote> Default Value: <CODE>-><-</CODE> </blockquote>
		</TD>
	</TR>
		<!-- =========== Summary =========== -->
	<TR>
		<TD width="100%">
			<h4><A HREF="#$_tmp_filename">$_tmp_filename</A></h4>
			<BR>
			<blockquote> Name of the temporal file in case OLE stream goes to stdout </blockquote>
			<blockquote> Default Value: <CODE>-><-</CODE> </blockquote>
		</TD>
	</TR>
	</TABLE>

<hr>
<!-- =========== INHERITED VAR SUMMARY =========== -->
<A NAME='inheritedvar_summary'><!-- --></A>
<h2>Inherited Class Variable Summary</h2>
<TABLE BORDER='1' CELLPADDING='3' CELLSPACING='0' WIDTH='100%'>

	</TABLE>
<hr>
<!-- =========== METHOD SUMMARY =========== -->
<A NAME='method_summary'><!-- --></A>
<H2>Method Summary</H2>
<TABLE BORDER='1' CELLPADDING='3' CELLSPACING='0' WIDTH='100%'>

		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#close'><H4>close (  )</H4></A>
			<BR>
			<blockquote> Write root entry, big block list and close the filehandle. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#OLEwriter'><H4>constructor OLEwriter ( $OLEfilename )</H4></A>
			<BR>
			<blockquote> Class for creating an OLEwriter </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >integer</td><td align="left" valign="top" width="100%">
			<A HREF='#set_size'><H4>set_size ( $biffsize )</H4></A>
			<BR>
			<blockquote> Set the size of the data to be written to the OLE stream. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#write'><H4>write ( $data )</H4></A>
			<BR>
			<blockquote> Write BIFF data to OLE file. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#write_header'><H4>write_header (  )</H4></A>
			<BR>
			<blockquote> Write OLE header block. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_calculate_sizes'><H4>_calculate_sizes (  )</H4></A>
			<BR>
			<blockquote> Calculate various sizes needed for the OLE stream </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_initialize'><H4>_initialize (  )</H4></A>
			<BR>
			<blockquote> Check for a valid filename and store the filehandle. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_write_big_block_depot'><H4>_write_big_block_depot (  )</H4></A>
			<BR>
			<blockquote> Write big block depot. </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_write_padding'><H4>_write_padding (  )</H4></A>
			<BR>
			<blockquote> Pad the end of the file </blockquote>
		</TD></tr></table>
	</td></TR>
		<!-- =========== Summary =========== -->
	<TR><td><table><tr>
		<td valign="top" >void</td><td align="left" valign="top" width="100%">
			<A HREF='#_write_property_storage'><H4>_write_property_storage (  )</H4></A>
			<BR>
			<blockquote> Write property storage. TODO: add summary sheets </blockquote>
		</TD></tr></table>
	</td></TR>
	</TABLE>
<!-- =========== INHERITED METHOD SUMMARY =========== -->
<A NAME='functions_inherited'><!-- --></A>
<H2>Inherited Method Summary</H2>
<TABLE BORDER='1' CELLPADDING='3' CELLSPACING='0' WIDTH='100%'>

	</TABLE>
<hr>
<!-- ============ METHOD DETAIL =========== -->

<A NAME='method_detail'></A>
<H2>Method Detail</H2>
<A NAME='close'><!-- --></A><H3>close <span class="functionlinenumber">(line 208)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>close (  )</H4></td></tr></table>

<b>Write root entry, big block list and close the filehandle.</b><br>
<p>This routine is used to explicitly close the open filehandle without  having to wait for DESTROY.</p>
<DL>

	<DT>Function Info:</DT>
		<DD><b>See</b> - <CODE>Workbook::store_OLE_file()</CODE></DD>
		<DD><b>Access</b> - <CODE>public</CODE></DD>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='OLEwriter'><!-- --></A><H3>OLEwriter <span class="functionlinenumber">(line 103)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>constructor OLEwriter ( $OLEfilename )</H4></td></tr></table>

<b>Class for creating an OLEwriter</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='set_size'><!-- --></A><H3>set_size <span class="functionlinenumber">(line 161)</span></H3>
<table><tr><td valign="top" align="right">integer</td><td align="left" valign="top" width="100%"><H4>set_size ( $biffsize )</H4></td></tr></table>

<b>Set the size of the data to be written to the OLE stream.</b><br>
<p>The maximun size comes from this:    $big_blocks = (109 depot block x (128 -1 marker word)                  - (1 x end words)) = 13842    $maxsize    = $big_blocks * 512 bytes = 7087104</p>
<DL>

	<DT>Function Info:</DT>
		<DD><b>Return</b> - <CODE>1 for success</CODE></DD>
		<DD><b>See</b> - <CODE>Workbook::store_OLE_file()</CODE></DD>
		<DD><b>Access</b> - <CODE>public</CODE></DD>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='write'><!-- --></A><H3>write <span class="functionlinenumber">(line 235)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>write ( $data )</H4></td></tr></table>

<b>Write BIFF data to OLE file.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='write_header'><!-- --></A><H3>write_header <span class="functionlinenumber">(line 244)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>write_header (  )</H4></td></tr></table>

<b>Write OLE header block.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_calculate_sizes'><!-- --></A><H3>_calculate_sizes <span class="functionlinenumber">(line 185)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_calculate_sizes (  )</H4></td></tr></table>

<b>Calculate various sizes needed for the OLE stream</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_initialize'><!-- --></A><H3>_initialize <span class="functionlinenumber">(line 123)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_initialize (  )</H4></td></tr></table>

<b>Check for a valid filename and store the filehandle.</b><br>
<p>Filehandle "-" writes to STDOUT</p>
<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_write_big_block_depot'><!-- --></A><H3>_write_big_block_depot <span class="functionlinenumber">(line 289)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_write_big_block_depot (  )</H4></td></tr></table>

<b>Write big block depot.</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_write_padding'><!-- --></A><H3>_write_padding <span class="functionlinenumber">(line 396)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_write_padding (  )</H4></td></tr></table>

<b>Pad the end of the file</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<A NAME='_write_property_storage'><!-- --></A><H3>_write_property_storage <span class="functionlinenumber">(line 319)</span></H3>
<table><tr><td valign="top" align="right">void</td><td align="left" valign="top" width="100%"><H4>_write_property_storage (  )</H4></td></tr></table>

<b>Write property storage. TODO: add summary sheets</b><br>

<DL>

	<DT>Function Info:</DT>
	</DL>
	<p class="top">[ <a href="#top">Top</a> ]</p>
<HR>
<hr>
<!-- ============ VARIABLE DETAIL =========== -->

<A NAME='variable_detail'></A>
<H2>Variable Detail</H2>

<A NAME='$_biffsize'><!-- --></A><H3>$_biffsize</H3>(line <span class="linenumber">72</span>)<br />
<b>Data type:</b> integer<br><b>Size of the data to be written to the OLE stream</b><br>

<UL>
	</UL>
<HR>
<A NAME='$_big_blocks'><!-- --></A><H3>$_big_blocks</H3>(line <span class="linenumber">84</span>)<br />
<b>Data type:</b> integer<br><b>Number of big blocks in the OLE stream</b><br>

<UL>
	</UL>
<HR>
<A NAME='$_booksize'><!-- --></A><H3>$_booksize</H3>(line <span class="linenumber">78</span>)<br />
<b>Data type:</b> integer<br><b>Real data size to be written to the OLE stream</b><br>

<UL>
	</UL>
<HR>
<A NAME='$_fileclosed'><!-- --></A><H3>$_fileclosed</H3>(line <span class="linenumber">66</span>)<br />
<b>Data type:</b> integer<br><b>Variable for preventing closing two times</b><br>

<UL>
	</UL>
<HR>
<A NAME='$_filehandle'><!-- --></A><H3>$_filehandle</H3>(line <span class="linenumber">54</span>)<br />
<b>Data type:</b> resource<br><b>Filehandle for the OLE stream</b><br>

<UL>
	</UL>
<HR>
<A NAME='$_list_blocks'><!-- --></A><H3>$_list_blocks</H3>(line <span class="linenumber">90</span>)<br />
<b>Data type:</b> integer<br><b>Number of list blocks in the OLE stream</b><br>

<UL>
	</UL>
<HR>
<A NAME='$_OLEfilename'><!-- --></A><H3>$_OLEfilename</H3>(line <span class="linenumber">48</span>)<br />
<b>Data type:</b> string<br><b>Filename for the OLE stream</b><br>

<UL>
		<LI><b>See</b> - <CODE>_initialize">_initialize()</a></CODE></LI>
	</UL>
<HR>
<A NAME='$_root_start'><!-- --></A><H3>$_root_start</H3>(line <span class="linenumber">96</span>)<br />
<b>Data type:</b> integer<br><b>Number of big blocks in the OLE stream</b><br>

<UL>
	</UL>
<HR>
<A NAME='$_tmp_filename'><!-- --></A><H3>$_tmp_filename</H3>(line <span class="linenumber">60</span>)<br />
<b>Data type:</b> string<br><b>Name of the temporal file in case OLE stream goes to stdout</b><br>

<UL>
	</UL>
<HR>
<hr>
	<div id="credit">
		<hr>
		Documention generated on Wed, 30 Apr 2003 11:14:31 -0400 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.2.0</a>
	</div>
</body>
</html>